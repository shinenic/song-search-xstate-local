{"version":3,"sources":["img/loading.svg","img/search.svg","img/cross.svg","config/history.js","machine/fsm.js","utils/localStorage.js","config/index.js","machine/guards.js","utils/base.js","utils/result.js","machine/actions.js","machine/services.js","machine/index.js","context/searchPage.js","components/result/idle.js","components/result/noResult.js","hooks/common/useScrollBottom.js","hooks/common/useDoubleClick.js","components/result/resultRow.js","components/result/showResult.js","components/common/loadingSpinner.js","components/result/index.js","hooks/common/useClickTouchOutside.js","hooks/useSearchBox.js","components/searchBox/index.js","components/main.js","searchPage.js","serviceWorker.js","index.js"],"names":["module","exports","createBrowserHistory","getRandomArbitrary","min","max","Math","random","searchPage","on","SET_KEYWORD","cond","actions","target","internal","TOGGLE_CLEAR","initial","states","idle","withData","READ_MORE","noData","buffering","after","searching","entry","exit","always","rootState","root","startup","fetchRawData","invoke","id","src","onDone","onError","processData","arrangeRawData","optimizeSearchSpeed","type","menu","CLOSE_MENU","OPEN_MENU","closed","TOGGLE_MENU","opened","SAVE_AND_CLOSE","error","RETRY","getLocalStorage","key","result","localStorage","getItem","JSON","parse","setLocalStorage","value","encodedValue","stringify","setItem","LOCAL_STORAGE_KEY","INITIAL_DATA","SELECTED_BOOKS_VOLUME_RANGE","SELECTED_BOOKS","DEFAULT_BOOKS_VOLUME_RANGE","SONG_SEARCH_KEY_FIELDS","withSettingInLocalStorage","values","every","isEmpty","isEmptyKeyword","_","keyword","isInvalidKeyword","str","last","test","withKeyword","hasNoResult","skipDebounceSearch","skipDebounce","getVolumeRange","list","targetBook","allVolume","filter","book","map","volume","toInteger","generateBookVolumeRange","initialData","booksWithVolumeFilter","reduce","acc","songs","gaActions","initialGA","ReactGA","initialize","debug","process","setPageview","pageview","window","location","pathname","search","sendDimension","set","ua","navigator","userAgent","k","routeActions","updateKeywordParam","history","push","assignActions","setKeyword","assign","clearKeyword","resetResult","pageNumber","readMore","setSelectedBooksVolumeRange","selectedBooksVolumeRange","setSelectedBooks","selectedBooks","searchSongList","songList","matchSorter","replace","keys","initializeData","data","availableBooks","booksVolumeRange","allSongList","toPairs","range","hasDefaultRange","includes","filterSongList","effectActions","scrollToTop","scrollTo","top","behavior","restoreSetting","storeSetting","fetchInitialData","Promise","resolve","reject","axios","get","then","response","catch","console","ZhuoZhuSearchMachine","Machine","context","guards","services","SearchPageContext","createContext","useSearchPageContext","useContext","SearchPageProvider","children","useMachine","devTools","state","send","Provider","openMenu","closeMenu","toggleMenu","toggleClear","saveOptionsAndClose","retry","getSearchPageContext","Idle","className","NoResult","useScrollBottom","handleScrollBottom","bottomThreshold","useEffect","handleScroll","innerHeight","pageYOffset","document","body","offsetHeight","addEventListener","removeEventListener","useDoubleClick","onDoubleClick","ref","useRef","clickTimeout","lastTapTime","current","handleDoubleClick","event","currentTime","Date","getTime","tapLengthOfTime","clearTimeout","preventDefault","setTimeout","ResultRow","React","memo","searchArtist","title","artist","page","titleRef","confirm","open","focus","showConnectToYoutube","artistRef","formattedResult","position","Result","useCallback","chunkedResult","slice","LoadingSpinner","isLoading","loadingIcon","alt","matches","useClickTouchOutside","handleClickTouchOutside","handleEvent","e","contains","useSearchBox","inputRef","searchBoxRef","blur","inputText","handleOnChange","handleClearBtnClick","showSearchIcon","handleSearchBtnClick","SearchBox","placeholder","onChange","searchIcon","onClick","crossIcon","SearchPage","isLocalhost","Boolean","hostname","match","registerValidSW","swUrl","config","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","controller","log","onUpdate","onSuccess","ReactDOM","render","StrictMode","getElementById","URL","href","origin","fetch","headers","contentType","status","indexOf","ready","unregister","reload","checkValidServiceWorker"],"mappings":"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","file":"static/js/main.50cd911e.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/loading.0f51771c.svg\";","module.exports = __webpack_public_path__ + \"static/media/search.fa72ba04.svg\";","module.exports = __webpack_public_path__ + \"static/media/cross.4f744e82.svg\";","import { createBrowserHistory } from 'history'\n\nexport default createBrowserHistory()\n","const BUFFER_TIME = 300\n\nconst getRandomArbitrary = (min, max) => {\n  return Math.random() * (max - min) + min\n}\n\nconst menuState = {\n  menu: {\n    initial: 'closed',\n    on: {\n      CLOSE_MENU: '.closed',\n      OPEN_MENU: '.opened',\n    },\n    states: {\n      closed: {\n        on: {\n          TOGGLE_MENU: 'opened',\n        },\n      },\n      opened: {\n        on: {\n          TOGGLE_MENU: 'closed',\n          SAVE_AND_CLOSE: {\n            target: 'closed',\n            actions: [\n              'setSelectedBooksVolumeRange',\n              'setSelectedBooks',\n              'filterSongList',\n            ],\n          },\n        },\n      },\n    },\n  },\n}\n\nconst searchPage = {\n  searchPage: {\n    on: {\n      SET_KEYWORD: [\n        {\n          cond: 'isEmptyKeyword',\n          actions: ['setKeyword', 'resetResult'],\n          target: '.idle.idle',\n        },\n        {\n          cond: 'isInvalidKeyword',\n          actions: ['setKeyword'],\n        },\n        {\n          cond: 'skipDebounceSearch',\n          actions: ['setKeyword'],\n          target: '.searching',\n        },\n        {\n          actions: ['setKeyword'],\n          target: '.buffering',\n          internal: false,\n        },\n      ],\n      TOGGLE_CLEAR: [\n        {\n          cond: 'hasNoResult',\n          actions: 'clearKeyword',\n          target: '.idle.idle',\n        },\n        { cond: 'withKeyword', actions: 'clearKeyword' },\n        { actions: 'resetResult', target: '.idle.idle' },\n      ],\n    },\n    initial: 'idle',\n    states: {\n      idle: {\n        initial: 'idle',\n        states: {\n          idle: {},\n          withData: {\n            on: {\n              READ_MORE: { actions: 'readMore' },\n            },\n          },\n          noData: {},\n        },\n      },\n      buffering: {\n        after: {\n          [BUFFER_TIME]: 'searching',\n        },\n      },\n      searching: {\n        entry: ['searchSongList', 'scrollToTop'],\n        exit: ['updateKeywordParam', 'sendDimension', 'setPageview'],\n        always: [\n          {\n            cond: 'hasNoResult',\n            target: 'idle.noData',\n          },\n          { target: 'idle.withData' },\n        ],\n      },\n    },\n  },\n}\n\nconst rootState = {\n  root: {\n    initial: 'startup',\n    states: {\n      startup: {\n        entry: ['initialGA', 'sendDimension', 'setPageview'],\n        always: [\n          {\n            cond: 'withSettingInLocalStorage',\n            target: 'idle',\n            actions: ['restoreSetting', 'filterSongList'],\n          },\n          { target: 'fetchRawData' },\n        ],\n      },\n      fetchRawData: {\n        invoke: {\n          id: 'fetch-initial-data',\n          src: 'fetchInitialData',\n          onDone: {\n            target: 'idle',\n            actions: ['initializeData', 'storeSetting', 'filterSongList'],\n          },\n          onError: 'error',\n        },\n      },\n      /* These three states are dummy aim to demo loading animation. */\n      processData: {\n        after: {\n          [getRandomArbitrary(2000, 4000)]: 'arrangeRawData',\n        },\n      },\n      arrangeRawData: {\n        after: {\n          [getRandomArbitrary(2000, 4000)]: 'optimizeSearchSpeed',\n        },\n      },\n      optimizeSearchSpeed: {\n        after: {\n          [getRandomArbitrary(1000, 3000)]: 'idle',\n        },\n      },\n      /* Dummy states end. */\n      idle: {\n        type: 'parallel',\n        states: {\n          ...menuState,\n          ...searchPage,\n        },\n      },\n      error: {\n        on: {\n          RETRY: 'fetchRawData',\n        },\n      },\n    },\n  },\n}\n\nexport default rootState\n","export const getLocalStorage = (key = '') => {\n  const result = localStorage.getItem(key)\n  return JSON.parse(result)\n}\n\nexport const setLocalStorage = (key, value = '') => {\n  const encodedValue = JSON.stringify(value)\n  localStorage.setItem(key, encodedValue)\n  return encodedValue\n}\n\nexport const removeLocalStorage = (key = '') => {\n  return localStorage.removeItem(key)\n}\n\nexport const clearLocalStorage = () => {\n  localStorage.clear()\n}\n","import { isDevMode } from 'utils/base'\n\nexport const DATA_COUNT_PER_PAGE = 15\n\nexport const GA_ID = 'UA-192564086-1'\n\nexport const INITIAL_DATA_PATH = isDevMode\n  ? '/zhuo-zhu-data.json'\n  : '/song-search-xstate-local/zhuo-zhu-data.json'\n\nexport const LOCAL_STORAGE_KEY = {\n  INITIAL_DATA: 'initial-data',\n  SELECTED_BOOKS_VOLUME_RANGE: 'selected-books-volume-range',\n  SELECTED_BOOKS: 'selected-books',\n}\n\nexport const DEFAULT_BOOKS_VOLUME_RANGE = {\n  '最新排行(簡譜)': [1, 104],\n}\n\nexport const SONG_FIELDS = {\n  BOOK: 'book',\n  TITLE: 'title',\n  ARTIST: 'artist',\n  VOLUME: 'volume',\n  PAGE: 'page',\n  TOTAL_PAGE: 'totalPage',\n  NOTE: 'note',\n}\n\nexport const SONG_SEARCH_KEY_FIELDS = [\n  SONG_FIELDS.BOOK,\n  SONG_FIELDS.TITLE,\n  SONG_FIELDS.ARTIST,\n  SONG_FIELDS.VOLUME,\n]\n","import { isZhuyin } from 'utils/base'\nimport { last, isEmpty, values } from 'lodash'\nimport { getLocalStorage } from 'utils/localStorage'\nimport { LOCAL_STORAGE_KEY } from 'config/index'\n\nexport default {\n  withSettingInLocalStorage: () =>\n    values(LOCAL_STORAGE_KEY).every(\n      (value) => !isEmpty(getLocalStorage(value))\n    ),\n\n  isEmptyKeyword: (_, { keyword }) => isEmpty(keyword),\n\n  isInvalidKeyword: (_, { keyword }) =>\n    isZhuyin(last(keyword)) || last(keyword) === ' ',\n\n  withKeyword: ({ keyword }) => !isEmpty(keyword),\n\n  hasNoResult: ({ result }) => isEmpty(result),\n\n  skipDebounceSearch: (_, { skipDebounce }) => skipDebounce,\n}\n","export const clearBlanks = (str) => {\n  return str.replace(/[\\r\\n\\s]/g, '')\n}\n\nexport const isZhuyin = (str) => {\n  const zhuyin = /[\\u3105-\\u3129\\u02CA\\u02C7\\u02CB\\u02D9]/\n  return zhuyin.test(str)\n}\n\nexport const showConnectToYoutube = (title, keyword) => {\n  const check = window.confirm(`連結至Youtube搜尋 \"${title}\" `)\n  if (check) {\n    window\n      .open(`https://www.youtube.com/results?search_query=${keyword}`, '_blank')\n      .focus()\n  }\n}\n\nexport const encodeQueryData = (data = {}) =>\n  Object.entries(data)\n    .map(\n      ([key, value]) =>\n        `${encodeURIComponent(key)}=${encodeURIComponent(value)}`\n    )\n    .join('&')\n\nexport const isDevMode = process.env.NODE_ENV === 'development'\n","import { toInteger, min, max } from 'lodash'\n\nexport const normalizeSearchResultText = (data) => {\n  /*\n   * If no artist data                       => Replace artist text with \"-\"\n   * If there are multi artists in one field => Replace \"/\" and \"+\" with \"line break\"\n   *                                           (based on \"white-space: pre-wrap;\")\n   */\n  const artistText =\n    data.artist === '' || data.artist === 'XXX'\n      ? '-'\n      : data.artist.replace(/[/+]/gi, '\\n')\n  const positionText =\n    data.volume === ''\n      ? toInteger(data.page)\n      : `${toInteger(data.volume)}/${toInteger(data.page)}`\n\n  return {\n    artist: artistText,\n    position: positionText,\n    title: data.title,\n  }\n}\n\nconst getVolumeRange = (list, targetBook) => {\n  const allVolume = list\n    .filter(({ book }) => book === targetBook)\n    .map(({ volume }) => toInteger(volume))\n  return [min(allVolume), max(allVolume)]\n}\n\nexport const generateBookVolumeRange = (initialData = {}) => {\n  return (initialData?.booksWithVolumeFilter || []).reduce(\n    (acc, book) => ({\n      ...acc,\n      [book]: getVolumeRange(initialData?.songs ?? [], book),\n    }),\n    {}\n  )\n}\n","import { assign } from 'xstate'\nimport { clearBlanks, isDevMode } from 'utils/base'\nimport { setLocalStorage, getLocalStorage } from 'utils/localStorage'\nimport { generateBookVolumeRange } from 'utils/result'\nimport history from 'config/history'\nimport {\n  LOCAL_STORAGE_KEY,\n  DEFAULT_BOOKS_VOLUME_RANGE,\n  SONG_SEARCH_KEY_FIELDS,\n  GA_ID,\n} from 'config/index'\nimport { isEmpty, keys, toPairs } from 'lodash'\nimport matchSorter from 'match-sorter'\n\nconst gaActions = {\n  initialGA: ({ ReactGA }) => {\n    ReactGA.initialize(GA_ID, { debug: isDevMode })\n  },\n  setPageview: ({ ReactGA }) => {\n    ReactGA.pageview(window.location.pathname + window.location.search)\n  },\n  sendDimension: ({ ReactGA, keyword = '' }) => {\n    ReactGA.set({ ua: navigator.userAgent })\n    ReactGA.set({ k: keyword })\n  },\n}\n\nconst routeActions = {\n  updateKeywordParam: ({ keyword }) => {\n    history.push({ search: `?k=${keyword}` })\n  },\n}\n\nconst assignActions = {\n  setKeyword: assign({ keyword: (_, { keyword = '' }) => keyword }),\n  clearKeyword: assign({ keyword: '' }),\n  resetResult: assign({ result: [], pageNumber: 1 }),\n  readMore: assign({ pageNumber: ({ pageNumber }) => pageNumber + 1 }),\n  setSelectedBooksVolumeRange: assign({\n    selectedBooksVolumeRange: (_, { selectedBooksVolumeRange = {} }) =>\n      selectedBooksVolumeRange,\n  }),\n  setSelectedBooks: assign({\n    selectedBooks: (_, { selectedBooks = [] }) => selectedBooks,\n  }),\n\n  searchSongList: assign({\n    result: ({ songList, keyword }) =>\n      matchSorter(songList, clearBlanks(keyword), {\n        keys: SONG_SEARCH_KEY_FIELDS,\n      }),\n  }),\n\n  initializeData: assign((_, { data: { data: initialData } }) => {\n    const { songs = [], availableBooks = [] } = initialData\n\n    const booksVolumeRange = generateBookVolumeRange(initialData)\n\n    const selectedBooksVolumeRange = toPairs(booksVolumeRange).reduce(\n      (acc, [book, range]) => {\n        const hasDefaultRange = keys(DEFAULT_BOOKS_VOLUME_RANGE).includes(book)\n        return {\n          ...acc,\n          [book]: hasDefaultRange ? DEFAULT_BOOKS_VOLUME_RANGE[book] : range,\n        }\n      },\n      {}\n    )\n\n    return {\n      initialData,\n      allSongList: songs,\n      selectedBooks: availableBooks,\n      availableBooks,\n      booksVolumeRange,\n      selectedBooksVolumeRange,\n    }\n  }),\n\n  filterSongList: assign(\n    ({ allSongList, selectedBooksVolumeRange, selectedBooks }) => {\n      const songList = allSongList.filter(({ book, volume }) => {\n        // Not available\n        if (!selectedBooks.includes(book)) return false\n\n        // Has no volume limitations\n        if (!keys(selectedBooksVolumeRange).includes(book)) return true\n\n        // Has no volume range\n        if (isEmpty(selectedBooksVolumeRange[book])) return true\n\n        const [min, max] = selectedBooksVolumeRange[book]\n        return volume >= min && volume <= max\n      })\n\n      return { songList }\n    }\n  ),\n}\n\nconst effectActions = {\n  scrollToTop: () => {\n    window.scrollTo({ top: 0, behavior: 'smooth' })\n  },\n\n  restoreSetting: assign(() => {\n    const initialData = getLocalStorage(LOCAL_STORAGE_KEY.INITIAL_DATA)\n    const selectedBooksVolumeRange = getLocalStorage(\n      LOCAL_STORAGE_KEY.SELECTED_BOOKS_VOLUME_RANGE\n    )\n    const selectedBooks = getLocalStorage(LOCAL_STORAGE_KEY.SELECTED_BOOKS)\n    const booksVolumeRange = generateBookVolumeRange(initialData)\n\n    return {\n      initialData,\n      selectedBooksVolumeRange,\n      selectedBooks,\n      booksVolumeRange: booksVolumeRange,\n      allSongList: initialData?.songs ?? [],\n      availableBooks: initialData?.availableBooks ?? [],\n    }\n  }),\n\n  storeSetting: ({ initialData, selectedBooksVolumeRange, selectedBooks }) => {\n    setLocalStorage(LOCAL_STORAGE_KEY.INITIAL_DATA, initialData)\n    setLocalStorage(LOCAL_STORAGE_KEY.SELECTED_BOOKS, selectedBooks)\n    setLocalStorage(\n      LOCAL_STORAGE_KEY.SELECTED_BOOKS_VOLUME_RANGE,\n      selectedBooksVolumeRange\n    )\n  },\n}\n\nexport default {\n  ...effectActions,\n  ...assignActions,\n  ...gaActions,\n  ...routeActions,\n}\n","import axios from 'axios'\nimport { INITIAL_DATA_PATH } from 'config/index'\n\nexport default {\n  fetchInitialData: () => {\n    return new Promise((resolve, reject) => {\n      axios\n        .get(INITIAL_DATA_PATH)\n        .then((response) => {\n          resolve(response)\n        })\n        .catch((error) => {\n          console.error(error)\n          reject(error)\n        })\n    })\n  },\n}\n","import { Machine } from 'xstate'\nimport states from './fsm'\nimport guards from './guards'\nimport actions from './actions'\nimport services from './services'\n\n/**\n * From static JSON file:\n *   booksWithVolumeFilter - Array\n *   availableBooks - Array\n *   books - Array\n *   songs - Array\n *\n * Custom options\n *   selectedBooksVolumeRange\n *   selectedBooks\n */\nconst initialContext = {\n  ReactGA: null,\n  keyword: '',\n  pageNumber: 1,\n  error: null,\n\n  // from raw data\n  initialData: {},\n  allSongList: [],\n  availableBooks: [],\n  booksVolumeRange: {},\n\n  // custom options\n  selectedBooksVolumeRange: {},\n  selectedBooks: [],\n  // list after filtered (volume & book)\n  songList: [],\n  // search result\n  result: [],\n}\n\nexport const ZhuoZhuSearchMachine = Machine(\n  {\n    id: 'ZhuoZhuSearch',\n    context: initialContext,\n    type: 'parallel',\n    states,\n  },\n  {\n    actions,\n    guards,\n    services,\n  }\n)\n","import React, { createContext, useContext } from 'react'\nimport { useMachine } from '@xstate/react'\nimport { ZhuoZhuSearchMachine } from 'machine/index'\nimport { isDevMode } from 'utils/base'\nimport ReactGA from 'react-ga'\n\nconst SearchPageContext = createContext()\n\nexport const useSearchPageContext = () => useContext(SearchPageContext)\n\n/* \n  @TODO:\n    1. History: save search history into local storage\n    2. Implement menu for other pages\n*/\nconst SearchPageProvider = ({ children }) => {\n  const [state, send] = useMachine(ZhuoZhuSearchMachine, {\n    devTools: isDevMode,\n    context: { ReactGA },\n  })\n\n  // For Debug\n  if (isDevMode) {\n    console.table(state.value)\n    console.log(state)\n    console.log(state.context)\n  }\n\n  const getSendActions = () => ({\n    openMenu: () => send('OPEN_MENU'),\n    closeMenu: () => send('CLOSE_MENU'),\n    toggleMenu: () => send('TOGGLE_MENU'),\n    setKeyword: (keyword = '', skipDebounce = false) =>\n      send({ type: 'SET_KEYWORD', keyword, skipDebounce }),\n    toggleClear: () => send('TOGGLE_CLEAR'),\n    saveOptionsAndClose: ({ selectedBooksVolumeRange, selectedBooks }) =>\n      send({ type: 'SAVE_AND_CLOSE', selectedBooksVolumeRange, selectedBooks }),\n    readMore: () => send('READ_MORE'),\n    retry: () => send('RETRY'),\n  })\n\n  const getSearchPageContext = () => {\n    const { context } = state\n    return {\n      state,\n      send,\n      context,\n      actions: {\n        ...getSendActions(),\n      },\n    }\n  }\n\n  return (\n    <SearchPageContext.Provider value={getSearchPageContext()}>\n      {children}\n    </SearchPageContext.Provider>\n  )\n}\n\nexport default SearchPageProvider\n","import React from 'react'\n\nconst Idle = () => (\n  <div className=\"idle-result\">Please enter something to search.</div>\n)\n\nexport default Idle\n","import React from 'react'\n\nconst NoResult = () => (\n  <div className=\"no-result\">Nothing found.</div>\n)\n\nexport default NoResult\n","import { useEffect } from 'react'\n\nconst useScrollBottom = (handleScrollBottom, bottomThreshold = 40) => {\n  useEffect(() => {\n    const handleScroll = () => {\n      if ((window.innerHeight + window.pageYOffset)\n        >= document.body.offsetHeight - bottomThreshold) {\n        handleScrollBottom()\n      }\n    }\n    window.addEventListener('scroll', handleScroll)\n    return () => {\n      window.removeEventListener('scroll', handleScroll)\n    }\n  })\n}\n\nexport default useScrollBottom\n","import { useRef, useEffect } from 'react'\n\nconst SINGLE_TAP_TIME_OUT = 450\n\nconst useDoubleClick = (onDoubleClick) => {\n  const ref = useRef()\n\n  useEffect(() => {\n    let clickTimeout = null\n    let lastTapTime = 0\n    const target = ref.current\n\n    const handleDoubleClick = (event) => {\n      const currentTime = new Date().getTime()\n      const tapLengthOfTime = currentTime - lastTapTime\n      clearTimeout(clickTimeout)\n\n      if (tapLengthOfTime > 0 && tapLengthOfTime < SINGLE_TAP_TIME_OUT) {\n        onDoubleClick()\n        event.preventDefault()\n      } else {\n        clickTimeout = setTimeout(() => { clearTimeout(clickTimeout) }, SINGLE_TAP_TIME_OUT)\n      }\n      lastTapTime = currentTime\n    }\n\n    target.addEventListener('click', handleDoubleClick)\n    return () => {\n      target.removeEventListener('click', handleDoubleClick)\n    }\n  })\n  return ref\n}\n\nexport default useDoubleClick\n","import React from 'react'\nimport useDoubleClick from 'hooks/common/useDoubleClick'\nimport { showConnectToYoutube } from 'utils/base'\nimport { normalizeSearchResultText } from 'utils/result'\n\nconst ResultRow = React.memo(\n  ({ searchArtist, title, artist, volume, page }) => {\n    const titleRef = useDoubleClick(() => {\n      showConnectToYoutube(title, `${title}+${artist.replace(/[/+]/gi, '+')}`)\n    })\n    const artistRef = useDoubleClick(() => searchArtist(artist))\n\n    const formattedResult = normalizeSearchResultText({\n      title,\n      volume,\n      page,\n      artist,\n    })\n\n    return (\n      <div className=\"row\">\n        <div className=\"row__title\" ref={titleRef}>\n          {formattedResult.title}\n        </div>\n        <div className=\"row__artist\" ref={artistRef}>\n          {formattedResult.artist}\n        </div>\n        <div className=\"row__position\">{formattedResult.position}</div>\n      </div>\n    )\n  }\n)\n\nexport default ResultRow\n","import React, { useCallback } from 'react'\nimport { DATA_COUNT_PER_PAGE } from 'config/index'\nimport { useSearchPageContext } from 'context/searchPage'\n\nimport useScrollBottom from 'hooks/common/useScrollBottom'\n\nimport ResultRow from './resultRow'\n\nconst Result = () => {\n  const {\n    context: { pageNumber = 1, result = [] },\n    actions: { readMore, setKeyword },\n  } = useSearchPageContext()\n\n  useScrollBottom(readMore)\n\n  const searchArtist = useCallback(\n    (artist) => {\n      setKeyword(artist, true)\n    },\n    [] // eslint-disable-line react-hooks/exhaustive-deps\n  )\n\n  const chunkedResult = result.slice(0, DATA_COUNT_PER_PAGE * pageNumber)\n\n  return (\n    <div className=\"with-result\">\n      {chunkedResult.map(({title, volume, page, artist}) => (\n        <ResultRow\n          key={`${title}${volume}${page}`}\n          title={title}\n          artist={artist}\n          volume={volume}\n          page={page}\n          searchArtist={searchArtist}\n        />\n      ))}\n    </div>\n  )\n}\n\nexport default Result\n","import React from 'react'\nimport loadingIcon from 'img/loading.svg'\n\nconst LoadingSpinner = React.memo(({ isLoading }) => (\n  <div className=\"fetch-more-loading\">\n    <img\n      src={loadingIcon}\n      alt=\"icon\"\n      className={'fetch-more-loading__icon' + (isLoading ? '' : ' hide')}\n    />\n  </div>\n))\n\nexport default LoadingSpinner\n","import React from 'react'\nimport { useSearchPageContext } from 'context/searchPage'\n\nimport Idle from './idle'\nimport NoResult from './noResult'\nimport ShowResult from './showResult'\nimport LoadingSpinner from 'components/common/loadingSpinner'\n\nconst Result = () => {\n  const { state } = useSearchPageContext()\n\n  switch (true) {\n    case state.matches('root.idle.searchPage.idle.idle'):\n      return <Idle />\n    case state.matches('root.idle.searchPage.idle.withData'):\n      return <ShowResult />\n    case state.matches('root.idle.searchPage.idle.noData'):\n      return <NoResult />\n    case !state.matches('root.idle'):\n      return <LoadingSpinner isLoading />\n    default:\n      return null\n  }\n}\n\nexport default Result\n","import { useEffect } from 'react'\n\nconst useClickTouchOutside = (ref = null, handleClickTouchOutside) => {\n  useEffect(() => {\n    const handleEvent = e => {\n      if (ref && !ref.current.contains(e.target)) {\n        handleClickTouchOutside()\n      }\n    }\n    document.addEventListener('mousedown', handleEvent)\n    document.addEventListener('touchstart', handleEvent)\n\n    return () => {\n      document.removeEventListener('mousedown', handleEvent)\n      document.removeEventListener('touchstart', handleEvent)\n    }\n  }, [ref, handleClickTouchOutside])\n}\n\nexport default useClickTouchOutside\n","import { useRef } from 'react'\nimport { isEmpty } from 'lodash'\nimport { useSearchPageContext } from 'context/searchPage'\nimport useClickTouchOutside from 'hooks/common/useClickTouchOutside'\n\nconst useSearchBox = () => {\n  const {\n    context: { keyword, result },\n    actions: { setKeyword, toggleClear },\n  } = useSearchPageContext()\n\n  const handleOnChange = (e) => {\n    setKeyword(e.target.value)\n  }\n\n  const inputRef = useRef(null)\n  const searchBoxRef = useRef(null)\n\n  const setInputFocus = () => {\n    inputRef.current.focus()\n  }\n  const setInputBlur = () => {\n    inputRef.current.blur()\n  }\n\n  const handleClearBtnClick = () => {\n    toggleClear()\n  }\n\n  // Blur input whenever user `touchstart outside` instead of `touchend outside`\n  useClickTouchOutside(searchBoxRef, setInputBlur)\n\n  return {\n    inputText: keyword,\n    inputRef,\n    searchBoxRef,\n    handleOnChange,\n    handleClearBtnClick,\n    showSearchIcon: isEmpty(result) && isEmpty(keyword),\n    handleSearchBtnClick: setInputFocus,\n  }\n}\n\nexport default useSearchBox\n","import React from 'react'\nimport useSearchBox from 'hooks/useSearchBox'\n\nimport searchIcon from 'img/search.svg'\nimport crossIcon from 'img/cross.svg'\n\nconst SearchBox = () => {\n  const {\n    inputText,\n    inputRef,\n    searchBoxRef,\n    handleOnChange,\n    handleClearBtnClick,\n    showSearchIcon,\n    handleSearchBtnClick,\n  } = useSearchBox()\n\n  return (\n    <div className=\"search-box\" ref={searchBoxRef}>\n      <input\n        className=\"search-box__input\"\n        type=\"text\"\n        placeholder=\"Title / Artist / Volume\"\n        value={inputText}\n        ref={inputRef}\n        onChange={handleOnChange}\n      />\n      {showSearchIcon ? (\n        <img\n          src={searchIcon}\n          alt=\"icon\"\n          className=\"search-box__icon search-box__icon--search\"\n          onClick={handleSearchBtnClick}\n        />\n      ) : (\n        <img\n          src={crossIcon}\n          alt=\"icon\"\n          className=\"search-box__icon search-box__icon--cross\"\n          onClick={handleClearBtnClick}\n        />\n      )}\n    </div>\n  )\n}\n\nexport default SearchBox\n","import React from 'react'\nimport Result from 'components/result/index'\nimport SearchBox from 'components/searchBox/index'\n\nconst SearchPage = () => (\n  <div className=\"main\">\n    <div className=\"search-page-placeholder\" />\n    <SearchBox />\n    <Result />\n  </div>\n)\n\nexport default SearchPage\n","import React from 'react'\nimport Main from 'components/main'\nimport SearchPageProvider from './context/searchPage'\n\nconst SearchPage = () => (\n  <SearchPageProvider>\n    <Main />\n  </SearchPageProvider>\n)\n\nexport default SearchPage\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport './styles/index.scss'\nimport history from 'config/history'\nimport SearchPage from './searchPage'\nimport { Router } from 'react-router-dom'\n\nimport * as serviceWorker from './serviceWorker'\n\nReactDOM.render(\n  <React.StrictMode>\n    <Router history={history}>\n      <SearchPage />\n    </Router>\n  </React.StrictMode>,\n  document.getElementById('root')\n)\n\nserviceWorker.register()\n"],"sourceRoot":""}